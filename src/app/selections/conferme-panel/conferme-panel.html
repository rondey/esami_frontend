@if(confermeStore.loadingState() === LoadingState.Loading) {
<div class="flex justify-center">
  <mat-spinner></mat-spinner>
</div>
} @else if(confermeStore.loadingState() === LoadingState.Loaded) {
<!-- TODO: Handle empty table -->
<table
  mat-table
  [dataSource]="confermeStore.conferme()"
  matSort
  (matSortChange)="onSortChange($event)"
  [matSortActive]="confermeStore.filter().sortBy"
  [matSortDirection]="confermeStore.filter().sortOrder"
>
  <ng-container matColumnDef="esameAmbulatorio.esame.descrizioneEsame">
    <th mat-header-cell *matHeaderCellDef mat-sort-header>Descrizione esame</th>
    <td mat-cell *matCellDef="let conferma">
      {{ conferma.esameAmbulatorio.esame.descrizioneEsame }}
    </td>
  </ng-container>

  <ng-container matColumnDef="esameAmbulatorio.esame.codiceMinisteriale">
    <th mat-header-cell *matHeaderCellDef mat-sort-header>Codice ministeriale</th>
    <td mat-cell *matCellDef="let conferma">
      {{ conferma.esameAmbulatorio.esame.codiceMinisteriale }}
    </td>
  </ng-container>

  <ng-container matColumnDef="esameAmbulatorio.esame.codiceInterno">
    <th mat-header-cell *matHeaderCellDef mat-sort-header>Codice interno</th>
    <td mat-cell *matCellDef="let conferma">{{ conferma.esameAmbulatorio.esame.codiceInterno }}</td>
  </ng-container>

  <ng-container matColumnDef="esameAmbulatorio.esame.posizione.descrizionePosizione">
    <th mat-header-cell *matHeaderCellDef mat-sort-header>Descrizione posizione</th>
    <td mat-cell *matCellDef="let conferma">
      {{ conferma.esameAmbulatorio.esame.posizione.descrizionePosizione }}
    </td>
  </ng-container>

  <ng-container matColumnDef="esameAmbulatorio.ambulatorio.descrizioneAmbulatorio">
    <th mat-header-cell *matHeaderCellDef mat-sort-header>Descrizione ambulatorio</th>
    <td mat-cell *matCellDef="let conferma">
      {{ conferma.esameAmbulatorio.ambulatorio.descrizioneAmbulatorio }}
    </td>
  </ng-container>

  <ng-container matColumnDef="createdAt">
    <th mat-header-cell *matHeaderCellDef mat-sort-header>Data conferma</th>
    <td mat-cell *matCellDef="let conferma">
      {{ conferma.createdAt | date : 'dd/MM/yyyy HH:mm' }}
    </td>
  </ng-container>

  <ng-container matColumnDef="actions">
    <th mat-header-cell *matHeaderCellDef>Azioni</th>
    <td mat-cell *matCellDef="let conferma">
      <button mat-icon-button>
        <mat-icon class="error" (click)="onDelete(conferma.id)">delete</mat-icon>
      </button>
    </td>
  </ng-container>

  <!-- Footer to show only in case of no records. Define the fictitious column  noRecords and the footer cell  -->
  <ng-container matColumnDef="noRecords">
    <td mat-footer-cell *matFooterCellDef [attr.colspan]="displayedColumns.length">
      <div class="no-records-cell">Non sono ancora presenti conferme</div>
    </td>
  </ng-container>

  <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
  <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
  <!-- Show the footer only in case of no records -->
  @if (confermeStore.conferme().length === 0) {
  <tr mat-footer-row *matFooterRowDef="['noRecords']"></tr>
  }
</table>
} @else {
<div class="flex justify-center">
  <button matButton="filled" (click)="getConferme()">
    <mat-icon>refresh</mat-icon>
    Ricarica la tabella
  </button>
</div>
}
